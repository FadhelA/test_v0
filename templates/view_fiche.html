<!-- templates/view_fiche.html -->
{% extends 'base.html' %}

{% block title %}
  {{ contenu.titre }}
{% endblock %}

{% block pre_content %}
  <div class="container-md col-lg-10 mt-4">
    <div class="header text-center">
      <h1 style="margin-bottom: 2rem;">{{ contenu.titre }}</h1>
    </div>
    <div class="container d-flex justify-content-center">
      <a href="/" class="btn btn-success btn-lg rounded-pill font-weight-bold" role="button"><span style="font-size: 1.4rem; white-space: pre;">Apprentissage actif</span></a>
    </div>

    <br />
    <br />

    <div class="container-md col-lg-11 main-content">
      <div class="row">
        <div class="col-lg-12">
          <div class="header text-center">
            <h1 style="font-size: 2.3em; margin-bottom: .6em;">En bref</h1>
          </div>

          <div class="card my-custom-card">
            <div class="card-header">
              <i class="fas fa-book-reader"></i> Résumé du cours
            </div>
            <div class="card-body text-justify">
              <p>{{ contenu.resume|safe }}</p>
            </div>
            <div class="card-fade"></div>
            <a href="#" class="card-toggle btn btn-outline-secondary btn-sm">&#x25BC;</a>
          </div>

          <div class="row d-flex">
            <div class="col-12 col-lg-6 mb-4">
              <div class="card my-custom-card">
                <div class="card-header">
                  <i class="fas fa-glasses"></i> Définitions
                </div>
                <div class="card-body">
                  <dl class="fa-ul">
                    {% for terme, definition in contenu.definitions.items() %}
                      <dt>
                        <span class="fa-li"><i class="fas fa-caret-right"></i></span>{{ terme }}
                      </dt>
                      <dd class="text-justify">{{ definition }}</dd>
                    {% endfor %}
                  </dl>
                </div>
                <div class="card-fade"></div>
                <a href="#" class="card-toggle btn btn-outline-secondary btn-sm">&#x25BC;</a>
              </div>
            </div>

            <div class="col-12 col-lg-6 mb-4">
              <div class="card my-custom-card">
                <div class="card-header">
                  <i class="fas fa-glasses"></i> Informations à connaitre
                </div>
                <div class="card-body" style="padding: 2px;">
                  <ul class="list-group list-group-flush">
                    {% for info in contenu.bullets %}
                      <li class="list-group-item">{{ info }}</li>
                    {% endfor %}
                  </ul>
                </div>
                <div class="card-fade"></div>
                <a href="#" class="card-toggle btn btn-outline-secondary btn-sm">&#x25BC;</a>
              </div>

            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}

{% block content %}
  <div class="container-lg main-content">
    <div class="row">
      <div class="col-lg-12">
        <div class="header text-center">
          <h1 style="font-size: 2.3em; margin-bottom: .6em;">Notions clefs</h1>
        </div>
        {% for notion, details in contenu['notions clefs'].items() %}
          <div class="card">
            <div class="card-header">
              <i class="far fa-lightbulb"></i> {{ notion }}
            </div>
            {% if 'summary' in details %}
              <div class="card-body text-justify" style="padding-bottom: 0.5em; padding-top: 0.5em;">
                <p style="margin-bottom: 0.5em; margin-top: 0.5em;">{{ details.summary|safe }}</p>
              </div>
              <!--                     
            <ul class="list-group list-group-flush">
                {% for detail in details.bullets %}
                  <li class="list-group-item">{{ detail|safe }}</li>
                {% endfor %}
            </ul>
                                 -->
            {% else %}
              <ul class="list-group list-group-flush">
                {% for detail in details %}
                  <li class="list-group-item">{{ detail }}</li>
                {% endfor %}
              </ul>
            {% endif %}
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
{% endblock %}

{% block javascript %}
  <script>
    $(document).ready(function () {
      $('.my-custom-card').each(function () {
        // Only show the fade and button if the content is larger than the max height
        if (this.scrollHeight > 400) {
          $(this).find('.card-fade').show()
          $(this).find('.card-toggle').show()
        } else {
          $(this).toggleClass('expanded')
        }
      })
    
      $('.card-toggle').click(function (e) {
        e.preventDefault()
        var card = $(this).closest('.my-custom-card')
    
        card.toggleClass('expanded')
        if (card.hasClass('expanded')) {
          //card.height(cardBody[0].scrollHeight) // Set to the full scroll height
          card.css('max-height', 'none')
        } else {
          //card.height(400) // Set back to max height
          card.css('max-height', '400px')
        }
      })
    })
  </script>
{% endblock %}
